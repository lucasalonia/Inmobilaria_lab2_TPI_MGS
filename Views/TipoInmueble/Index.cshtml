@model IEnumerable<Inmobilaria_lab2_TPI_MGS.Models.TipoInmueble>
@{
    ViewData["Title"] = "Gestión de Tipos de Inmueble";
}

<div class="container-fluid">
    @if (!string.IsNullOrEmpty(ViewBag.ErrorMessage))
    {
        <div class="alert alert-danger alert-dismissible fade show" role="alert">
            <i class="fas fa-exclamation-triangle me-2"></i>
            <strong>Error:</strong> @ViewBag.ErrorMessage
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Cerrar"></button>
        </div>
    }
    
    @if (!string.IsNullOrEmpty(TempData["SuccessMessage"] as string))
    {
        <div class="alert alert-success alert-dismissible fade show" role="alert">
            <i class="fas fa-check-circle me-2"></i>
            <strong>Éxito:</strong> @TempData["SuccessMessage"]
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Cerrar"></button>
        </div>
    }
    
    <div class="row">
        <div class="col-12">
            <div class="card">
                <div class="card-header d-flex justify-content-between align-items-center">
                    <h3 class="card-title mb-0">
                        <i class="fas me-2"></i>Tipos de Inmueble
                    </h3>
                    <a class="btn btn-primary" asp-action="Create" title="Crear Nuevo tipo inmueble">
                        <i class="fas fa-plus me-1"></i>Nuevo tipo inmueble
                    </a>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-striped table-hover">
                            <thead class="table-dark">
                                <tr>
                                    <th>ID</th>
                                    <th>Nombre</th>
                                    <th>Descripción</th>
                                    <th class="text-center">Acciones</th>
                                </tr>
                            </thead>
                            <tbody>
                                @foreach (var item in Model)
                                {
                                    <tr>
                                        <td>@item.Id</td>
                                        <td>@item.Nombre</td>
                                        <td>@item.Descripcion</td>
                                        <td class="text-center">
                                            <div class="btn-group" role="group">
                                                <a class="btn btn-sm btn-outline-warning" 
                                                    asp-action="Edit" 
                                                    asp-route-id="@item.Id" 
                                                    title="Editar">
                                                    <i class="fas fa-edit"></i>
                                                </a>
                                                <a class="btn btn-sm btn-outline-danger" 
                                                    href="javascript:void(0);"
                                                    data-bs-toggle="modal"
                                                    data-bs-target="#eliminarModal"
                                                    data-id="@item.Id"
                                                    data-nombre="@item.Nombre"
                                                    title="Eliminar">
                                                    <i class="fas fa-trash"></i>
                                                </a>                                        
                                            </div>
                                        </td>
                                    </tr>
                                }
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


<!-- Modal Confirmación Eliminar -->
<div class="modal fade" id="eliminarModal" tabindex="-1" aria-labelledby="eliminarModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<form id="formEliminar" method="post" asp-action="Delete">
				<div class="modal-header">
					<h5 class="modal-title" id="eliminarModalLabel">Confirmar Eliminación</h5>
					<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
				</div>
				<div class="modal-body">
					<p id="mensajeEliminar"></p>
					<input type="hidden" id="EliminarId" name="Id" />
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
					<button type="submit" class="btn btn-danger">Eliminar</button>
				</div>
			</form>
		</div>
	</div>
</div>

@section Scripts {
    <script>
        var eliminarModal = document.getElementById('eliminarModal');
        eliminarModal.addEventListener('show.bs.modal', function (event) {
            var button = event.relatedTarget;

            var Id = button.getAttribute('data-id');
            var Nombre = button.getAttribute('data-nombre') || "-";

            // mensaje
            var mensaje = "¿Está seguro que desea eliminar el tipo de inmueble?";
            mensaje += "<br><strong>Nombre:</strong> " + Nombre;

            document.getElementById('mensajeEliminar').innerHTML = mensaje;
            document.getElementById('EliminarId').value = Id;
        });
    </script>
}



